好的同学们
在上节课当中啊
我们刚刚学习了docker的原理
那么为了更好的去使用docker啊
我们还需要去理解一下docker的架构
也就是我们这节课要学习的内容
而docker架构当中有几个比较重要的概念
首先就是`镜像和容器`
什么是镜像呢
大家这个不陌生了
`我们的docker啊会将应用程序及其所需要的依赖
函数库
环境配置等等都给它打包在一起
这个东西就叫镜像`
比方说我们之前讲过的这个mysql镜像
那它里面肯定就会有各种各样所需要的依赖吧
`这些东西最终落地到硬盘
就是一个一个的文件`
比方说这里有mysql运行时需要写数据的
data目录文件
还有log日志文件
当然还有bin里面的可执行文件等等
这些就组成了mysql这个应用本身
还有就是mysl所需要的各种各样的函数库了
那么也就是说镜像就是硬盘中的文件

`那容器又是怎么回事呢
你可以简单理解成
我们把这个mysql的应用给它跑起来
形成的这个进程就是容器`
只不过在docker里边
`容器还要做隔离
也就是说
我们的容器可以看作是这样的一个小盒子`
`这个盒子里边将来会利用我们linux的手段啊
给它形成隔离空间
里面会有自己独立的cpu资源
内存资源
甚至于还有独立的文件系统
那么因此在这个容器内运行的这个进程
它就会以为自己是这台计算机上的唯一进程了
从而起到一种隔离的效果`

那将来我们mysql镜像不管是启动成一个容器
还是启动成多个容器
它们之间都是相互隔离的

`那么当容器运行的过程中
必然会做一种数据读写操作`

比方说我们的mysql将来肯定要去存数据吧
存到哪了
data目录啊

`那他们能不能把自己的数据
写到这个镜像的data目录里面去呢
显然不能
因为如果他们这么做了
不就等于对镜像产生了污染了吗
人家干干净净的一个镜像
让你咔咔一顿血
万一你写的时候还造成了一些垃圾的东西
导致这个镜像将来不可用了
那怎么办呢`

所以说同学们  `镜像都是只读的`
`也就是说容器在运行过程中
你不能往镜像里写东西`
你可以基于镜像去创建容器
`然后容器呢可以从里边去读数据
但不能写`
那我将来mysql容器我往哪儿写
数据呢
`很简单
你呢拷贝一份文件
到你自己的独立文件系统当中
这就是隔离的一个特性了吗
那你在写数据的时候
你写到自己的空间里
会对别的容器产生影响吗
不会吧
会对音响产生影响吗
也不会吧
那包括你将来记日志也是如此
大家呢各写各的
将来我们再基于这个镜像创建全新的容器
是不是也是全新的
里边都是空空的好
那只有这样呢
我们的镜像才可以放心大胆的交给别人去使用
因为镜像不会被干扰
也不会被影响`
那问题来了


我们怎么样把镜像共享给别人去使用呢
比如说共享给你的同事
或者共享给网络中的其他程序员
那就要用到我们的第二个概念了
`就是dockham dog hub呀
是一个docker镜像的托管平台
它就跟我们的github很像
github是不是来做代码的托管的啊
我们的dog hub做镜像托管这样的平台
我们统称之为叫docker registry
也就是镜像服务器`
那我们的程序员呢可以利用我们的docker
提供的一些命令去完成进行的构建
构建出啊
mysql redis啊
各种各样的镜像
然后呢

把这些镜像上传到我们到hub
这样的服务器上去
当然我们docker官方也写了很多很多的优良镜像
把它都放到了door hub这样的服务器上
那像这样的服务器
国内也有很多啊
有阿里云啊
什么网易云啊
都有这样的服务器
当然如果你觉得这些服务器在外网公开太危险

公司内部的这种东西你不想公开
你也可以搭建私有的云服务器

这些呢都叫docker registry好
那么这就是我们这个竞相贡献的一个方案了
那问题来了
我们该怎么样利用docker完成镜像构建
`或者是从远端拉取镜像呢
又该怎么样去运行容器呢`

这就需要了解docker的架构了
那么docker呢  `是一个cs架构的程序`
它里边有`两部分`组成
一呢就是`server`
`也就这里的server端负责接收用户指令
完成镜像和容器的各种各样的操作
你不管是构建镜像还是从远端拉取镜像
还是将来我们去运行容器
都是有server端来完成的`
那谁给server下指令呢
`自然就是我们的client端
也就是这里的client端
它可以向docker下达命令`

或者是发送rest一篇的请求
当然这是看你在哪发
如果你就在docker所在的机器上本地来发
那你就用命令就可以了
如果你将来是远程操作docker
你就用rest api去发就行了
比方说我们就是本地
我就通过命令就行了
我想构建一个镜像
我可以用一个docker build命令
这个命令到达docker server以后啊
会被docker的守护进程docker demon去接收和处理
那么他会利用你提供的这些个数据
`给它构建成一个镜像`
那除了这种方式去获取镜像以外

我们还可以去docker registry里拉取镜像
因为我们registry里边会有docker
官方提供的各种优质镜像
那这个时候我们想拉屎的时候
可以通过一个docker pull命令
docker pool呢也会把请求发送到docker server端
而我们的docker守护进程就会去registry
拉去你指定的这个景象了
那下边是不是就开始运行镜像创建容器了呀
那这个时候就要用到一个命令叫docker run
那么他会告诉我们的server要去创建容器

而我们的守护进程就会帮助你完成容器的创建
然后你的部署就完成了
虽然呀我们可以自己构建镜像
也可以从远程拉取
但一般情况下
像这种redis
mysql index等等这样的一些应用

我们建议大家直接使用官方镜像就可以了
你没有必要自己构建
只有一些我们自己的微服务
或者你自己需要去做一些深度定制
你才需要构建
`那因此呢我们一般使用docker
主要就是向docker server发命令`
想办法呢得到镜像
不管是用哪种方式
`然后呢再把镜像创建成容器运行
完成部署就可以了
这就是docker的一个整体架构了啊`

那我们来回顾一下这节课所讲的内容
这节课里呢我们主要学习了镜像容器
docker架构
还有dohub这么几个东西
镜像就是把我们的应用
依赖环境等等都给它打包在一起
就得到镜像了
而容器呢就是把我们的镜像给启动起来
形成的就是容器了
只不过容器要形成隔离空间
里边有自己独立的cpu啊
内存啊
甚至文件系统避免容器去修改镜像
污染镜像
而我们的一个镜像啊可以去启动成多个容器
将来形成集群啊
而docker的架构里边
主要有服务端和客户端两部分组成
服务端主要是接收我们的客户端命令的
将来去实现进行的操作
还有容器的操作
而客户端就是负责发送命令到docker的
docker hub呢其实是一种docker的镜像托管服务
那类似的还有我们的阿里云
网易云等等都可以去做啊
那所有的这些服务呢统称为docker registry啊
镜像服务器
好的同学们
那我们这节课的内容就到这里了
