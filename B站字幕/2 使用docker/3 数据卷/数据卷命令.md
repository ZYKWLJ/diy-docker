好同学们
在上节课当中
我们已经学习了docker容器的相关操作
然后我们发现有一个问题啊
那就是我们的`docker容器
它里边的所有文件也好
数据也好
都是跟容器耦合在一起的`

因此呢给我们带来了很多问题
第一个问题就是不便于修改
`如果我要去修改数据
我不得不进入到docker容器的内部取`
而里边呢又没有什么高级的编辑工具
修改起来非常麻烦
第二个问题呢是 `数据不可复用的问题`
对容器内的所有修改都是`对外不可见`的
那么你在容器里边一顿改
而且随着时间的迁移
你改的越来越多
可能你自己都不知道改了什么了

将来又创建了新的容器
也希望与原来容器达到相同效果时
你会发现呀
你要把原来的所有动作重复再做一遍
也就是说`你所做的那些个修改
对其他容器来讲是不可复用的`
`你不得不重复劳动 `

第三个问题呢是升级维护困难的问题
`数据全部存在容器的内部
如果有一天我们要对容器的版本进行升级
那老的容器是不是必须得删掉啊
当容器一旦删掉
那容器里面的数据呢也都全跟着删了`


所以啊我们必须得想办法`解决
容器与数据耦合的问题`

怎么解决呢
就是我们这节课要学习的数据卷知识了

数据卷它的英文叫`volume`
它是一个`虚拟目录`啊
它`指向的是宿主机文件系统中的一个 真实的目录`
比如说呀我这里有一个docker的主机
那么在这个主机上呀
`就会由docker去管理很多很多的数据卷
而所有的这些个数据
一定会指向宿主机文件系统上的一个目录`

这个目录是谁呢
就是v lab docker下的volumes
比方说我现在呢利用docker创建了一个新的数据卷
这个数据的名字叫html
那么我们的docker一定会在这个指定的宿主机
文件系统下创建出一个html的目录
比方说我又创建了一个新的数据卷
那么它同样会在volumes目录下

再创建一个真实目录
`然后每一个数据卷都跟一个真实的目录呢
进行一个映射`
所以呢你可以认为·`数据卷它是一个虚拟的
并不真实存在的
只是一个概念
而真正指向的是硬盘上的一个真实文件夹`好
那我们的容器在创建以后呢

它就可以使用这个数据卷
比方说我现在有一个容器是index容器
我们知道nginx它的html目录是在usr share nginx tm目录下
这是不是容器内的目录啊
那么将来呢我们如果放任不管nginx
它的所有的tml文件
还有一些静态资源文件都会放到这个目录下
他的所有配置都会放到上面这个目录下
那么就是数据与容器耦合了
那现在我们可以怎么办呢

我们可以让`index的内部目录与数据卷进行关联`
而当它与数据键进行关联时
那么这个时候
它的本质其实是在跟宿主机文件系统上的
这个目录进行关联
那么这个时候呢docker就会去管理这个容器了
`比方说我现在在这个容器的http目录里
写了点什么东西
那么这些东西会立即写到宿主机文件系统里
而反过来
如果说我在宿主机文件系统里
对html文件夹里边的某一个文件进行了修改
那么这种修改呀
也立即会反映到容器内的这样一个目录里面去`

也就是说你可以认为他俩
他俩就通过html这样一个数据卷
是不是搭起了桥
建立起了联系了呀
那同学们
我们之前所说的几个问题
是不是由此就解决了呀
`第一个问题我们讲什么呀
是不是修改不方便呀
那现在修改是不是很方便了`
为什么呀
因为你对宿主机文件系统的一个任意修改
就这个tm目录下的任意修改
那么一定会立即反映到跟这个对应数据卷
关联的容器内部吧
也就是说你在这改了什么容器里
立马可以看到
你再也不用进入容器内去修改了呀
我们直接在宿主机上面
通过高级编辑工具任意修改
是不是很方便
`第二个问题我们讲说什么呀
数据共享的问题吧
现在呢你对这个容器一顿改
比如说我改了好多好多的配置
那我又创建了一个新的容器
我希望这个配置能够共享过来
那怎么办呀
我可以让这个容器的config目录
也来挂在config数据卷
也就是说两个容器是不是可以挂在同一个圈啊
那这个时候呢
原来你在这个config目录里做的一切修改
那我这个新的容器是不是也能看到了`

这就是数据共享啊
还有第三个我们讲什么呀
`数据的安全删除的问题`
是不是将来有一天你要升级版本
`结果你咔把这个容器给删了
好
没关系啊
因为你容器删了
但是数据卷会不会跟着删
不会啊
属于卷是挂载在容器的这个目录上
你容器删了
我居然还在
那我的硬盘目录也在我里面
所有数据呢也都还在
将来你又来了个新的容器
新版本的你只要接着挂载到这两个数据卷上
那是不是可以共享以前旧的数据了`

这样我们之前所说的三个问题
是不是全都解决了
那么我们该怎么样去操作数据卷呢
同学们可以看一下啊
这里数据卷的操作命令啊是`一个二级命令`啊
第一集是`docker volume`
接下来才是真正的命令了
那这些命令呢包括create创建一个新的volume
还有inspect显示一个或多个volume的详细信息
也就是说我来查一查你这个volume
你是在哪个位置啊
你实际硬盘关联在哪里啊
就是用这个来查
然后呢

还有`ls呢是列出所有的volume`
还有prin prin呢是删除目前没人用的volume
比如说我有很多volume
但是有一些呢暂时没有容器去用
那么通过这个命令可以把他们全部干掉
然后还有一个是`rm`
这个是`删除指定的volume`
比如说我要删谁

我就把他的名字缀在后边就行了
那么上述这些就是我们docker volume
操作的常见命令了啊

那下边呢我们就来演示一下
这里要求我们创建一个数据卷
并且查看它在宿主机上的位置
下边我们进入shell控制台来做一个演示
首先我们通过docker volume杠杠help来查看帮助文档
我们可以看到啊
这个命令docky command
后边跟上这么多的一些信息啊
刚才是不是全部介绍过一遍了
下边呢我们就逐一演示啊
先来看create docker volume
create后面跟上什么呢
数据卷的名称
比方说html哎回车
那这样是不是创建了一个名为html的数据卷
好
那我怎么知道有没有创建成功呢
我们可以通过docker volume谁呀
是不是l s呀
列出所有的数据卷
可以看到我这里有两个数据卷
这个是我们刚刚创建的吗
那这个显然是以前docker自己创建的吧
你看这名字超级变态
一看就是自动生成的吧
啊这个我们就不管它了
那我们的数据创建成功了
它到底存在硬盘中的哪个位置呀
我们可以通过docker volume inspect来查看吧
来docker volume aspect后面跟上数据卷的名称html
然后回车可以看到
这里就显示出了我们这个卷的详细信息了
特别需要大家关注的自然就是它的存储目录了
也就是挂载点在哪呢
vlab docker volumes htm下划线data
你看是不是我们刚刚所说的这个目录
dok vlab volumes下的情报
只不过呀他在下边又有一个下划线
data的一个目录
这里边是真实存储的啊
好
那么这样呢我们就知道了数据卷到底挂在哪了
是不是啊
那下边儿呢我们想删除一个数据卷
我们怎么办呢
有两种做法啊
删除未使用的数据卷
第二个呢是删除指定数据卷
那这个呢是我们刚刚创建的
没人用的
这个显然是有人在用的
我们通过docker volume prune来演示一下
回车他问你了
说这将移除所有的本地未使用的券
你确定吗
我说确定
那么然后你发现他就删掉了一个
然后我们看一下docker volume
ls s是不是只剩下一个了
哎这就是删除未使用的卷啊
那这个时候我们是通过docker volume create
再把刚才那个emt创建回来
来
再看一眼是不是回来了
如果说我们想把它删除呢
那我们还可以再用一个docker volume的什么动作呀
rm吧
后面跟上要删掉那个卷的名称
html也是可以的
回车好
我们再来看一眼
往上翻
回车看是不是没有了
当然你还可以再把它创建出来
docker volume什么呀
哎create吧
htm走是不是创建出来了
再看一眼上走
这样是不是看到了新的这个atm创建好了
好这就是我们书院相关命令的一个演示了啊
那同学们我们回到ppt那创建数据卷呢
create查看l s查看详细信息
用的是inspect
那我们呢最后做一个总结
数据卷的作用是什么呀
同学们是不是解除容器数据卷的耦合呀
然后呢可以提高我们数据的复用性
并且方便我们操作里面的数据吧
保证数据安全
那数据卷的操作呢主要就包括了create
创建l s查看所有expect
查看详情
删除还未使用的很好啊
那我们这节课的内容就到这里了
同学们
下节课呢我们就会来学习
如何将数据卷挂载到容器当中
